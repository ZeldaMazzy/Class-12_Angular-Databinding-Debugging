"use strict";(self.webpackChunkBookIt=self.webpackChunkBookIt||[]).push([[861],{4861:(x,m,n)=>{n.r(m),n.d(m,{LibraryModule:()=>J});var p=n(9808),b=n(6110),S=n(9800),v=n(727),t=n(1223),d=n(8038);class g{constructor(r,e,s,i,h,c,u){this.title=r,this.author=e,this.genre=s,this.coverImgPath=i,this.price=h,this.firstPublishYear=c,this.isbn=u}}var k=n(7579),L=n(2340),T=n(520);let f=(()=>{class o{constructor(e){this.http=e,this.bookList$=new k.x,this.librarySearchResults=[],this.baseURL="http://openlibrary.org/search.json?",this.firebaseURL=L.N.firebaseRootURL}fetchBooks(e){this.librarySearchResults=[];const s=this.splitSearch(e);this.http.get(this.baseURL+"q="+s).subscribe(i=>{this.processBooks(i),this.bookList$.next(this.librarySearchResults)})}processBooks(e){e.docs.slice(0,11).forEach(s=>{const{title:i,author_name:h,first_publish_year:c,isbn:u}=s,N=new g(i,h,"","https://tse2.mm.bing.net/th?id=OIP.I6LGwie40Vw4K8gmV52MKwHaLc&pid=Api&P=0&w=300&h=300",0,c,u);this.librarySearchResults.push(N)})}splitSearch(e){return e.split(" ").join("+").toLowerCase()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(T.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var a=n(2382);let R=(()=>{class o{constructor(e){this.libraryService=e}fetchBooks(e){this.libraryService.fetchBooks(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-book-search"]],decls:8,vars:2,consts:[[1,"form-inline",3,"ngSubmit"],["searchForm","ngForm"],[1,"form-group","mr-2"],["for","search",1,"sr-only"],["type","search","name","search","id","search","placeholder","Search","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){t.CHM(i);const c=t.MAs(1);return s.fetchBooks(c.value.search)}),t.TgZ(2,"div",2),t.TgZ(3,"label",3),t._uU(4,"Search"),t.qZA(),t.TgZ(5,"input",4),t.NdJ("ngModelChange",function(c){return t.CHM(i),t.MAs(1).value.search=c}),t.qZA(),t.qZA(),t.TgZ(6,"button",5),t._uU(7," Search "),t.qZA(),t.qZA()}if(2&e){const i=t.MAs(1);t.xp6(5),t.Q6J("ngModel",i.value.search),t.xp6(1),t.Q6J("disabled",!i.valid)}},directives:[a._Y,a.JL,a.F,a.Fj,a.Q7,a.JJ,a.On],styles:[""]}),o})();var Z=n(7388);function C(o,r){1&o&&(t.TgZ(0,"div",3),t._uU(1," Please search for a book.\n"),t.qZA())}function A(o,r){1&o&&(t.TgZ(0,"div",4),t._uU(1," No books could be found from the search :(\n"),t.qZA())}function B(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",5),t.TgZ(1,"div",6),t._UZ(2,"app-book",7),t.TgZ(3,"button",8),t.NdJ("click",function(){const h=t.CHM(e).$implicit;return t.oxw().onSaveBook(h)}),t._uU(4," + "),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=r.$implicit;t.xp6(2),t.Q6J("book",e)}}let E=(()=>{class o{constructor(e,s){this.bookshelfService=e,this.libraryService=s,this.bookList=[],this.componentState=l.PRE_SEARCH}ngOnInit(){this.libraryService.bookList$.subscribe(e=>{this.bookList=e.slice(),this.componentState=0==e.length?l.NO_RESULTS:l.WITH_RESULTS})}onSaveBook(e){this.bookshelfService.createBook(e)}get state(){return l}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.c),t.Y36(f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-book-results"]],decls:3,vars:3,consts:[["class","alert alert-info mt-5",4,"ngIf"],["class","alert alert-warning mt-5",4,"ngIf"],["class","row mb-3 mt-5",4,"ngFor","ngForOf"],[1,"alert","alert-info","mt-5"],[1,"alert","alert-warning","mt-5"],[1,"row","mb-3","mt-5"],[1,"col-md-12",2,"display","flex"],[2,"width","100%",3,"book"],[1,"float-right","btn","btn-light",2,"border","none","font-size","16px",3,"click"]],template:function(e,s){1&e&&(t.YNc(0,C,2,0,"div",0),t.YNc(1,A,2,0,"div",1),t.YNc(2,B,5,1,"div",2)),2&e&&(t.Q6J("ngIf",s.componentState==s.state.PRE_SEARCH),t.xp6(1),t.Q6J("ngIf",s.componentState==s.state.NO_RESULTS),t.xp6(1),t.Q6J("ngForOf",s.bookList))},directives:[p.O5,p.sg,Z.W],styles:[""]}),o})();var l=(()=>{return(o=l||(l={}))[o.PRE_SEARCH=0]="PRE_SEARCH",o[o.NO_RESULTS=1]="NO_RESULTS",o[o.WITH_RESULTS=2]="WITH_RESULTS",l;var o})(),U=n(8549);const M=[{path:"",component:(()=>{class o{constructor(e){this.bookshelfService=e,this.alert="",this.bookSubscription$=new v.w0}ngOnInit(){this.bookSubscription$=this.bookshelfService.bookSelected.subscribe({next:e=>{this.alert=`Successfully added book ${e.title} by ${e.author} to our personal bookshelf!`}})}ngOnDestroy(){this.bookSubscription$.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.c))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-library"]],decls:10,vars:1,consts:[[1,"row"],[1,"col-lg-6","col-md-12"],[1,"col-9"],[3,"message"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5"),t._uU(3,"API Library results"),t.qZA(),t.qZA(),t.TgZ(4,"div",1),t._UZ(5,"app-book-search"),t.qZA(),t.qZA(),t.TgZ(6,"div",0),t.TgZ(7,"div",2),t._UZ(8,"app-book-results"),t.qZA(),t.qZA(),t._UZ(9,"app-alert",3)),2&e&&(t.xp6(9),t.Q6J("message",s.alert))},directives:[R,E,U.w],styles:[""]}),o})(),canActivate:[S.a]}];let I=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[b.Bz.forChild(M)],b.Bz]}),o})();var F=n(4466);let J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,F.m,a.u5,I]]}),o})()}}]);